<html>
  <head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="style.css">
  </head>
  <body onkeydown="bodyKeyPress();">
    <button id="generate-button" onclick="generate();">Uus number</button>
    <input id="number-field" style="display:none;" onkeypress="keypress();" type="text">
    <span id="result-block"></span>
    <div>
      <button id="play-button" style="display:none;" onclick="play();">Kuula uuesti</button>
      <button id="show-button" style="display:none;" onclick="show();">Vaata õige vastus</button>
    </div>
  </body>
  <script>
    var number;
    var audio;
    var oNumberField = document.getElementById("number-field");
    var oPlayButton = document.getElementById("play-button");
    var oShowButton = document.getElementById("show-button");
    var oResultBlock = document.getElementById("result-block");

    function show() {
      oNumberField.value = number;
    }
    function generate() {
      number = Math.floor(Math.random()*99);
      console.log("Genereeritud: " + number);
      var lang = 'et';
      var filename = lang + '/' + number + '.mp3'
      oNumberField.style.display = 'initial';
      oPlayButton.style.display = 'initial';
      oShowButton.style.display = 'initial';
      oNumberField.value = '';
      oResultBlock.innerHTML = '';
      audio = new Audio(filename);
      play();
    };

    function play() {
      audio.play();
      oNumberField.focus();
    };

    function keypress(e) {
      if (!e) e = window.event;
      var key = e.key;
      if (key == 'Enter'){
        check();
        return false;
      } else {
        oResultBlock.innerHTML = '';
      }
    };

    function bodyKeyPress(e) {
      if (!e) e = window.event;
      var key = e.key;
      if (key == 'Escape') {
        generate();
        return false;
      }
    };

    function check() {
      console.log("Sisestatud: " + oNumberField.value);
      if (oNumberField.value == number) {
        oResultBlock.style.color = 'darkgreen';
        oResultBlock.innerHTML = 'Õige!'
        oShowButton.style.display = 'none';
      } else {
        oResultBlock.style.color = 'darkred';
        oResultBlock.innerHTML = 'Vale!'
        oShowButton.style.display = 'initial';
      }
    };
  </script>
</html>
